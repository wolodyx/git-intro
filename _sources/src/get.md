# Получение хранилища


## Введение

Существуют два способа заполучить хранилище на рабочем компьютере:
1) склонировать существующее;
2) создать новое.

Рассмотрим каждый из них подробнее.


## Клонирование хранилища

<!-- О команде `git clone` -->
Команда `git clone` клонирует существующее хранилище, адрес которого передано в качестве аргумента команды.
Клонируемое хранилище называют *удаленным*, даже если оно расположено в локальной файловой системе.
Клонирование создает копию удаленного хранилища, называемого *локальным*.
Дополнительно, она извлекает рабочую копию последних версий файлов.

<!-- Пример клонирования удаленного репозитория -->
Для пример воспользуемся удаленным хранилищем проекта MPICH, расположенного по адресу `https://github.com/pmodels/mpich.git`.
Покажем три примера работы команды `git clone` с клонированием в
* каталог, название которого команда выберет сама;
* каталог, имя которого выбрал пользователь;
* текущий пустой каталог.

Команда `git clone https://github.com/pmodels/mpich.git` создает в текущем каталоге каталог `mpich`, название которого совпадает с названием удаленного хранилища в аргументе-адресе.
```console
bob@pc:~/projects$ git clone https://github.com/pmodels/mpich.git
Клонирование в «mpich»...
remote: Enumerating objects: 250143, done.
remote: Counting objects: 100% (3214/3214), done.
remote: Compressing objects: 100% (1278/1278), done.
remote: Total 250143 (delta 2145), reused 2749 (delta 1933), pack-reused 246929
Получение объектов: 100% (250143/250143), 86.52 МиБ | 5.65 МиБ/с, готово.
Определение изменений: 100% (194822/194822), готово.
bob@pc:~/projects$ cd mpich/
bob@pc:~/projects/mpich$ ls
autogen.sh  confdb        contrib       COPYRIGHT  examples  Makefile.am  mpich-doxygen.in  RELEASE_NOTES  test
CHANGES     configure.ac  CONTRIBUTING  doc        maint     modules      README.vin        src
```
Если перед клонированием такой каталог существовал, тогда команда завершилась бы с ошибкой.
Чтобы склонировать хранилище в другой рабочий каталог, его имя передается в команду следующим аргументом после адреса:
``` bash
git clone https://github.com/pmodels/mpich.git mpich2
```
На практике сначала создают новый каталог, переходят туда и клонируют.
При клонировании вместо имени каталога передают аргумент `.`, обозначающий текущий каталог:
``` bash
mkdir mpich
cd mpich
git clone https://github.com/pmodels/mpich.git .
```

```{warning}
Часто точку (обозначение текущего каталога) в конце команды не замечают.
Или ее не видят или думают, что она обозначает конец предложения.
```

<!-- Клонирование только части истории -->
Большие проекты клонируются долго и нагружают сеть.
Большую часть передаваемых данных занимает история.
При медленной скорости загрузки или ограниченного трафика мы готовы пожертвовать частью истории в пользу быстрой загрузки.
Опция `--depth` (переводится с английского как "глубина") принимает целое число -- количество последних коммитов, которые будут загружены.
```
git clone --depth=1 https://github.com/pmodels/mpich.git
```


## Об удаленных хранилищах

<!-- О GitHub -->
Совместная работа над созданием программы требует удаленное хранилище, которое было бы доступно всем членам команды.
Удаленное хранилище располагается на специальном сервере, называемом *Git-сервером*.
Такой сервер требует обслуживания.
Небольшие компании не могут позволить себе тратить ресурсы на собственные физические сервера.
Сервис GitHub предлагает бесплатно услугу по размещению хранилищ Git.
Дополнительно, вокруг этого она создает набор сервисов, которые необходимы при разработке ПО:
* отслеживание ошибок;
* создание сайта проекта (GitHub Pages);
* автоматическая сборка программы (GitHub Actions);
* документирование проекта (GitHub Wiki).

Все эти сервисы GitHub предоставляет бесплатно.
За небольшую плату можно получить расширенные возможности сервисов.
Большинство проектов программ с открытым исходным кодом размещаются на серверах [GitHub](https://github.com).
Вот небольшой список проектов, которые используют сервера GitHub для разработки ПО:
* [GoogleTest - Google Testing and Mocking Framework](https://github.com/google/googletest)
* [Git Source Code Mirror](https://github.com/git/git)
* [Official MPICH Repository](https://github.com/pmodels/mpich)

GitHub является компанией, предоставляющей облачный сервис для разработки программ.
Эти сервисы работают только на серверах самой компании.
Клиенты могут закрыть свои хранилища, т.е. сделать их приватными.
Тогда к этим хранилищам могут иметь доступ только те участники, у которых есть доступ.
Не все компании могут позволить себе перенести свои исходные коды на неконтролируемые ими сервера.
Для таких случаев существует проект [GitLab](https://gitlab.com) в рамках которого создается ПО для обслуживания процессов разработки программ.
GitLab является альтернативой GitHub.
Ее программу можно запустить на собственном сервере, получая полный контроль над ним.
Дополнительно этому GitLab предоставляет те же самые услуги, что и GitHub, используя свое ПО.
Вот небольшой список проектов, которые используют сервера GitLab для разработки ПО:
* [Eigen](https://gitlab.com/libeigen/eigen.git)
* [CMake](https://gitlab.kitware.com/cmake/cmake)

<!-- О форматах путей к удаленным хранилищам -->


## Создание нового хранилища

Любое хранилище в начале было кем-то создано.
Команда `git init` создает пустое хранилище в текущем каталоге или в каталоге, переданном в виде аргумента.
Пустое хранилище не содержит истории, а его рабочая копия пуста.
Рабочий каталог может содержать файлы, которые в последствии будут добавлены в хранилище.
Как это сделать, будет рассмотрено в разделе ["Фиксация изменений"](commit.md).

Каталог является рабочим для хранилища, если внутри себя содержит каталог `.git`.
Символ "точка" в начале имени указывает, что системе UNIX  он скрытый и не отобразится стандартными средствами.
Команда `ls` выведет на терминале вместе с остальными скрытые файлы и каталоги при вызове с опцией `--all`.


## Контрольные вопросы

1. Воспользуйтесь существующим пустым каталогом в качестве рабочего каталога для клонируемого хранилища.


## Упражнения

1. Склонируйте хранилище json из сервера github.com у пользователя nlohmann.
1. Сравните скорость загрузки одного и того же хранилища с полной и неполной историей.
   Для примера воспользуйтесь хранилищем `https://github.com/nlohmann/json.git`.

