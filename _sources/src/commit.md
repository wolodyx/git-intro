# Фиксация изменений

Команда `git commit` фиксирует изменения в хранилище, добавляя во внутреннюю базу данных запись, называемую *коммитом*.
С коммитом связан следующий набор данных:
* изменения в файлах;
* сообщение, описывающее изменения;
* дата и время фиксации;
* имя и электронная почта автора изменений.

Дата и время фиксации берутся из системного времени в момент выполнения команды.
Локальное системное время должно быть синхронизировано с мировым, чтобы не возникло казусов уже при синхронизации хранилищ.

Имя и электронная почта автора берутся из системы.
Там они были заданы при [настройке `Git`](config.md).
Если настройка не была проведена, то выполнить фиксацию не получится.

<!-- Отслеживаемые и неотслеживаемые файлы -->
Система следит только за теми файлами, о которых ей известно по ревизии, из которой извлечена рабочая копия.
Эти файлы называются отслеживаемыми (tracked), тогда как остальные -- неотслеживаемые (untracked).
На практике в рабочей копии обычно содержатся файлы, полученные в результате сборки -- объектные, исполняемые, временные файлы, которые генерируются автоматически и не представляют интереса для контроля версий.
Обычная практика -- хранить артефакты сборки в рабочем каталоге в отдельном каталоге, например, `build`.

<!-- Измененный, индексированный и зафиксированный файлы -->
Отслеживаемые файлы могут быть в трех состояниях: *неизменными*, *измененными* и *подготовленными к фиксации*.
После извлечения рабочей копии всей файлы относятся к неизменным.
Если отслеживаемый файл был отредактирован, то он рассматривается измененным.
Перед фиксацией измененный файл должен быть выбран -- помещен в *область индексирования* или, коротко, *индекс*.
Индекс является третье областью, где храняться файлы, дополнительно к рабочей копии и хранилищу.

<!-- Работа с индексом -->
Команда `git add` помещает фиксируемые файлы в индекс, еще говорят -- индексирует файлы.
Эта же команда применима и к неотслеживаемым файлам, чтобы превратить их в историю.

<!-- `git add` и шаблоны в аргументах -->
`git add *.c`.
`git add test*.cpp`

<!-- `git status` или информация о состоянии файлов -->
Команда `git status` показывает состояния отслеживаемых и список неотслеживаемых файлов.
В примере ниже она показывает, что файл `LampServer.cpp` изменен и неотслеживаются файлы из каталога `build/`.

``` bash
skt@home:~/MyProjects/RemoteLamps$ git status
На ветке main
Ваша ветка обновлена в соответствии с «origin/main».

Изменения, которые не в индексе для коммита:
  (используйте «git add <файл>…», чтобы добавить файл в индекс)
  (используйте «git restore <файл>…», чтобы отменить изменения в рабочем каталоге)
	изменено:      LampServer.cpp

Неотслеживаемые файлы:
  (используйте «git add <файл>…», чтобы добавить в то, что будет включено в коммит)
	build/

нет изменений добавленных для коммита
(используйте «git add» и/или «git commit -a»)
```

Проиндексируем измененный файл командой `git add LampServer.cpp` и еще раз посмотрим на вывод команды `git status`:

``` bash
skt@home:~/MyProjects/RemoteLamps$ git status
На ветке main
Ваша ветка обновлена в соответствии с «origin/main».

Изменения, которые будут включены в коммит:
  (используйте «git restore --staged <файл>…», чтобы убрать из индекса)
	изменено:      LampServer.cpp

Неотслеживаемые файлы:
  (используйте «git add <файл>…», чтобы добавить в то, что будет включено в коммит)
	build/
```

Команда `git status` имеет подробный вывод и полезна в начале.
Но с опытом эта многословность начинает мешать.
Опция `-s` делает вывод более компактным:

```bash
skt@home:~/MyProjects/RemoteLamps$ git status -s
M  LampServer.cpp
?? build/
```

<!-- Фиксация изменений в Git -->
Подготовив индекс, мы можем зафиксировать изменения командой `git commit`.
Команда откроет текстовый файл.

`git commit -v`

Если описание коммита однострочное, то его можно передать команде через аргумент опции `-m`:
``` bash
git commit -m "Описание изменений"
```

